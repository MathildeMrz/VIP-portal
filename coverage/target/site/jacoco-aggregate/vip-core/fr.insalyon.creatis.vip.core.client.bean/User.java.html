<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="fr"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>User.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">coverage</a> &gt; <a href="../index.html" class="el_bundle">vip-core</a> &gt; <a href="index.source.html" class="el_package">fr.insalyon.creatis.vip.core.client.bean</a> &gt; <span class="el_source">User.java</span></div><h1>User.java</h1><pre class="source lang-java linenums">/*
 * Copyright and authors: see LICENSE.txt in base repository.
 *
 * This software is a web portal for pipeline execution on distributed systems.
 *
 * This software is governed by the CeCILL-B license under French law and
 * abiding by the rules of distribution of free software.  You can  use,
 * modify and/ or redistribute the software under the terms of the CeCILL-B
 * license as circulated by CEA, CNRS and INRIA at the following URL
 * &quot;http://www.cecill.info&quot;.
 *
 * As a counterpart to the access to the source code and  rights to copy,
 * modify and redistribute granted by the license, users are provided only
 * with a limited warranty  and the software's author,  the holder of the
 * economic rights,  and the successive licensors  have only  limited
 * liability.
 *
 * In this respect, the user's attention is drawn to the risks associated
 * with loading,  using,  modifying and/or developing or reproducing the
 * software by the user in light of its specific status of free software,
 * that may mean  that it is complicated to manipulate,  and  that  also
 * therefore means  that it is reserved for developers  and  experienced
 * professionals having in-depth computer knowledge. Users are therefore
 * encouraged to load and test the software's suitability as regards their
 * requirements in conditions enabling the security of their systems and/or
 * data to be ensured and,  more generally, to use and operate it in the
 * same conditions as regards security.
 *
 * The fact that you are presently reading this means that you have had
 * knowledge of the CeCILL-B license and that you accept its terms.
 */
package fr.insalyon.creatis.vip.core.client.bean;

import com.google.gwt.user.client.rpc.IsSerializable;
import fr.insalyon.creatis.vip.core.client.view.CoreConstants.GROUP_ROLE;
import fr.insalyon.creatis.vip.core.client.view.user.UserLevel;
import fr.insalyon.creatis.vip.core.client.view.util.CountryCode;

import java.sql.Timestamp;
import java.util.Date;
import java.util.Iterator;
import java.util.Map;
import java.util.Set;


/**
 * @author Rafael Ferreira da Silva
 */
public class User implements IsSerializable {

    private String firstName;
    private String lastName;
    private String email;
    private String nextEmail;
    private String institution;
    private String password;
    private boolean confirmed;
    private String code;
    private String folder;
    private String session;
    private Date registration;
    private Date lastLogin;
    private UserLevel level;
    private int maxRunningSimulations;
    private CountryCode countryCode;
    private Map&lt;Group, GROUP_ROLE&gt; groups;
    private boolean hasGroups;
    private Timestamp termsOfUse;
    private Timestamp lastUpdatePublications;
    private int failedAuthentications;
    private boolean accountLocked;

    private Boolean isGridFile;
    private Boolean isGridJob;

<span class="nc" id="L76">    public User() {</span>
<span class="nc" id="L77">    }</span>

<span class="fc" id="L79">    public User(String firstName, String lastName, String email, String institution, String password, UserLevel level, CountryCode countryCode, String applications) {</span>
<span class="fc" id="L80">    }</span>

    public User(String firstName, String lastName, String email, String institution, UserLevel level, CountryCode countryCode) {

<span class="fc" id="L84">        this(firstName, lastName, email, null, institution, &quot;&quot;, false, &quot;&quot;, &quot;&quot;,</span>
                &quot;&quot;, null, null, level, countryCode, 1, null, null, 0, false);

<span class="fc" id="L87">    }</span>

    public User(String firstName, String lastName, String email, String institution, String password, UserLevel level, CountryCode countryCode) {

<span class="fc" id="L91">        this(firstName, lastName, email, null, institution, password, false, &quot;&quot;, &quot;&quot;,</span>
                &quot;&quot;, null, null, level, countryCode, 1, null, null, 0, false);

<span class="fc" id="L94">    }</span>

    public User(String firstName, String lastName, String email, String institution,
                String password, CountryCode countryCode, Timestamp lastUpdatePublications) {

<span class="fc" id="L99">        this(firstName, lastName, email, null, institution, password, false,</span>
                &quot;&quot;, &quot;&quot;, &quot;&quot;, new Date(), new Date(), null, countryCode, 1, null, lastUpdatePublications, 0, false);
<span class="fc" id="L101">    }</span>

    public User(
            String firstName,
            String lastName,
            String email,
            String nextEmail,
            String institution,
            String password,
            boolean confirmed,
            String code,
            String folder,
            String session,
            Date registration,
            Date lastLogin,
            UserLevel level,
            CountryCode countryCode,
            int maxRunningSimulations,
            Timestamp termsOfUse,
            Timestamp lastUpdatePublications,
            int failedAuthentications,
            boolean locked
<span class="fc" id="L123">    ) {</span>

<span class="fc" id="L125">        this.firstName = firstName;</span>
<span class="fc" id="L126">        this.lastName = lastName;</span>
<span class="fc" id="L127">        this.email = email;</span>
<span class="fc" id="L128">        this.nextEmail = nextEmail;</span>
<span class="fc" id="L129">        this.institution = institution;</span>
<span class="fc" id="L130">        this.password = password;</span>
<span class="fc" id="L131">        this.confirmed = confirmed;</span>
<span class="fc" id="L132">        this.code = code;</span>
<span class="fc" id="L133">        this.folder = folder;</span>
<span class="fc" id="L134">        this.session = session;</span>
<span class="fc" id="L135">        this.registration = registration;</span>
<span class="fc" id="L136">        this.lastLogin = lastLogin;</span>
<span class="fc" id="L137">        this.level = level;</span>
<span class="fc" id="L138">        this.maxRunningSimulations = maxRunningSimulations;</span>
<span class="fc" id="L139">        this.countryCode = countryCode;</span>
<span class="fc" id="L140">        this.termsOfUse = termsOfUse;</span>
<span class="fc" id="L141">        this.lastUpdatePublications = lastUpdatePublications;</span>
<span class="fc" id="L142">        this.failedAuthentications = failedAuthentications;</span>
<span class="fc" id="L143">        this.accountLocked = locked;</span>
<span class="fc" id="L144">    }</span>

    public boolean isConfirmed() {
<span class="fc" id="L147">        return confirmed;</span>
    }

    public String getCode() {
<span class="fc" id="L151">        return code;</span>
    }

    public String getEmail() {
<span class="fc" id="L155">        return email;</span>
    }

    public String getNextEmail() {
<span class="fc" id="L159">        return nextEmail;</span>
    }

    public String getFirstName() {
<span class="fc" id="L163">        return firstName;</span>
    }

    public String getFolder() {
<span class="fc" id="L167">        return folder;</span>
    }

    public String getInstitution() {
<span class="fc" id="L171">        return institution;</span>
    }

    public String getLastName() {
<span class="fc" id="L175">        return lastName;</span>
    }

    public String getPassword() {
<span class="fc" id="L179">        return password;</span>
    }

    public void setCode(String code) {
<span class="fc" id="L183">        this.code = code;</span>
<span class="fc" id="L184">    }</span>

    public void setFolder(String folder) {
<span class="fc" id="L187">        this.folder = folder;</span>
<span class="fc" id="L188">    }</span>

    public void setPassword(String password) {
<span class="fc" id="L191">        this.password = password;</span>
<span class="fc" id="L192">    }</span>

    public String getFullName() {
<span class="fc" id="L195">        return firstName + &quot; &quot; + lastName;</span>
    }

    public boolean isSystemAdministrator() {
<span class="fc bfc" id="L199" title="All 2 branches covered.">        return level == UserLevel.Administrator;</span>
    }

    public boolean isDeveloper() {
<span class="fc bfc" id="L203" title="All 2 branches covered.">        return level == UserLevel.Developer;</span>
    }

    public String getSession() {
<span class="nc" id="L207">        return session;</span>
    }

    public Date getLastLogin() {
<span class="fc" id="L211">        return lastLogin;</span>
    }

    public void setLastLogin(Date lastLogin) {
<span class="fc" id="L215">        this.lastLogin = lastLogin;</span>
<span class="fc" id="L216">    }</span>

    public UserLevel getLevel() {
<span class="fc" id="L219">        return level;</span>
    }

    public void setLevel(UserLevel level) {
<span class="fc" id="L223">        this.level = level;</span>
<span class="fc" id="L224">    }</span>

    public int getMaxRunningSimulations() {
<span class="fc" id="L227">        return maxRunningSimulations;</span>
    }

    public void setMaxRunningSimulations(int maxRunningSimulations) {
<span class="fc" id="L231">        this.maxRunningSimulations = maxRunningSimulations;</span>
<span class="fc" id="L232">    }</span>

    public CountryCode getCountryCode() {
<span class="fc" id="L235">        return countryCode;</span>
    }

    public void setCountryCode(CountryCode countryCode) {
<span class="fc" id="L239">        this.countryCode = countryCode;</span>
<span class="fc" id="L240">    }</span>

    public Date getRegistration() {
<span class="fc" id="L243">        return registration;</span>
    }

    public void setRegistration(Date registration) {
<span class="fc" id="L247">        this.registration = registration;</span>
<span class="fc" id="L248">    }</span>

    public void setGroups(Map&lt;Group, GROUP_ROLE&gt; groups) {
<span class="fc" id="L251">        this.groups = groups;</span>
<span class="pc bpc" id="L252" title="1 of 2 branches missed.">        this.hasGroups = !groups.isEmpty();</span>
<span class="fc" id="L253">        filterGroups();</span>
<span class="fc" id="L254">    }</span>

    public Timestamp getTermsOfUse() {
<span class="fc" id="L257">        return termsOfUse;</span>
    }

    public void setTermsOfUse(Timestamp termsOfUse) {
<span class="fc" id="L261">        this.termsOfUse = termsOfUse;</span>
<span class="fc" id="L262">    }</span>

    public Boolean getIsgridfile() {
<span class="nc" id="L265">        return isGridFile;</span>
    }

    public void setIsgridfile(Boolean isgridfile) {
<span class="nc" id="L269">        this.isGridFile = isgridfile;</span>
<span class="nc" id="L270">    }</span>

    public Boolean getIsgridjobs() {
<span class="nc" id="L273">        return isGridJob;</span>
    }

    public void setIsgridjobs(Boolean isgridjobs) {
<span class="nc" id="L277">        this.isGridJob = isgridjobs;</span>
<span class="nc" id="L278">    }</span>

    public Timestamp getLastUpdatePublications() {
<span class="fc" id="L281">        return lastUpdatePublications;</span>
    }

    public void setLastUpdatePublications(Timestamp lastUpdatePublications) {
<span class="fc" id="L285">        this.lastUpdatePublications = lastUpdatePublications;</span>
<span class="fc" id="L286">    }</span>

    public boolean hasGroupAccess(String groupName) {

<span class="nc bnc" id="L290" title="All 2 branches missed.">        for (Group group : groups.keySet()) {</span>
<span class="nc bnc" id="L291" title="All 2 branches missed.">            if (group.getName().equals(groupName)) {</span>
<span class="nc" id="L292">                return true;</span>
            }
<span class="nc" id="L294">        }</span>
<span class="nc" id="L295">        return false;</span>
    }

    public Set&lt;Group&gt; getGroups() {
<span class="nc" id="L299">        return groups.keySet();</span>
    }

    private void filterGroups() {
<span class="fc" id="L303">        Iterator&lt;Group&gt; it = groups.keySet().iterator();</span>
<span class="fc bfc" id="L304" title="All 2 branches covered.">        while (it.hasNext()) {</span>
<span class="fc" id="L305">            Group group = it.next();</span>
<span class="pc bpc" id="L306" title="1 of 2 branches missed.">            if (groups.get(group) == GROUP_ROLE.None) {</span>
<span class="nc" id="L307">                it.remove();</span>
            }
<span class="fc" id="L309">        }</span>
<span class="fc" id="L310">    }</span>

    public boolean isGroupAdmin() {

<span class="fc bfc" id="L314" title="All 2 branches covered.">        for (GROUP_ROLE role : groups.values()) {</span>
<span class="fc bfc" id="L315" title="All 2 branches covered.">            if (role == GROUP_ROLE.Admin) {</span>
<span class="fc" id="L316">                return true;</span>
            }
<span class="fc" id="L318">        }</span>
<span class="fc" id="L319">        return false;</span>
    }

    public boolean isGroupAdmin(String groupName) {

<span class="nc bnc" id="L324" title="All 2 branches missed.">        for (Group group : groups.keySet()) {</span>
<span class="nc bnc" id="L325" title="All 2 branches missed.">            if (group.getName().equals(groupName)</span>
<span class="nc bnc" id="L326" title="All 2 branches missed.">                    &amp;&amp; groups.get(group) == GROUP_ROLE.Admin) {</span>
<span class="nc" id="L327">                return true;</span>
            }
<span class="nc" id="L329">        }</span>
<span class="nc" id="L330">        return false;</span>
    }

    public boolean hasAcceptTermsOfUse() {
<span class="pc bpc" id="L334" title="1 of 2 branches missed.">        return getTermsOfUse() != null;</span>
    }

    public boolean hasGroups() {
<span class="nc" id="L338">        return hasGroups;</span>
    }

    public int getFailedAuthentications() {
<span class="nc" id="L342">        return this.failedAuthentications;</span>
    }

    public boolean isAccountLocked() {
<span class="fc" id="L346">        return this.accountLocked;</span>
    }

    @Override
    public String toString() {
<span class="fc" id="L351">        return email;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>